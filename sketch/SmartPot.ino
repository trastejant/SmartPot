//Llamadas a las librerias necesarias

#include <ASCII.h>//Libreria de caracteres ASCII
#include <NokiaLCD.h>//Libreria para el display
#include <DHT.h>//Libreria del sensor de temperatura y humedad

//Configuracion del sensor de humedad y temperatura

#define DHTPIN 12//Declaramos que el sensor esta en el pin 12
#define DHTTYPE DHT11//Definimos el modelo del sensor    
DHT dht(DHTPIN, DHTTYPE);//Definimos un objeto que utilizaremos para comunicarnos con el sensor    

//Configuracion del display
NokiaLCD NokiaLCD(3,4,5,6,7); // (SCK, MOSI, DC, RST, CS) 

//Definicion de constantes
#define umbralLuminosidad 200
#define umbralOscuridad 20
#define umbralCalor 35
#define umbralFrio 10
#define umbralHumedad 150

//Definicion de variables    
boolean tMenu = true;
float Acthum, ActTemp, AntTemp, AntHum;
int backlight = 8;
int luminosidad = 0;
int HumTierra = 0;
//Variables auxiliares

char humedad[6];
char temperatura[6];

//Caras del modo grafico--------------------------------------->

//imagen de carita sonriente
static unsigned char smille[] = {

0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0x7F, 0x7F, 0x3F, 0x3F, 0x3F, 0x1F, 0x1F, 0x0F, 
0x0F, 0x0F, 0x07, 0x07, 0x07, 0x07, 0x07, 0x03, 0x03, 0x03, 0x03, 
0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x07, 0x07, 
0x07, 0x07, 0x07, 0x0F, 0x0F, 0x0F, 0x0F, 0x1F, 0x1F, 0x3F, 0x3F, 
0x7F, 0x7F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0x7F, 0x3F, 0x1F, 0x0F, 0x07, 0x03, 0x03, 0x01, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 
0xE0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xC0, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x80, 0xC0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0, 0xC0, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x03, 0x03, 0x07, 0x07, 0x0F, 0x3F, 0x7F, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x0F, 0x01, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x0F, 0x0F, 0x0F, 0x1F, 
0x0F, 0x0F, 0x0F, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x0F, 0x0F, 
0x1F, 0x1F, 0x0F, 0x0F, 0x0F, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x1F, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xF0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x40, 0x40, 0x40, 0x00, 0x40, 0xE0, 0x90, 0x88, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x88, 0x90, 0xE0, 0x40, 0x00, 
0x40, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x80, 0xF8, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFC, 0xF8, 0xF0, 0xE0, 0xC0, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x06, 0x04, 0x0C, 0x0C, 0x08, 
0x18, 0x38, 0x30, 0x30, 0x30, 0x30, 0x60, 0x60, 0x60, 0x60, 0x40, 
0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x60, 0x60, 0x60, 
0x60, 0x30, 0x30, 0x30, 0x30, 0x38, 0x18, 0x08, 0x0C, 0x0C, 0x04, 
0x06, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x80, 0xC0, 0xC0, 0xE0, 0xF0, 0xF8, 0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFE, 0xFC, 0xFC, 0xF8, 0xF8, 
0xF8, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0, 0xE0, 0xC0, 0xC0, 0xC0, 0xC0, 
0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 
0x80, 0x80, 0x80, 0x80, 0x80, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 
0xC0, 0xC0, 0xC0, 0xE0, 0xE0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF8, 0xF8, 
0xF8, 0xFC, 0xFC, 0xFE, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF

};

//icono de carita triste
static unsigned char triste[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x70, 0x70, 0x38, 
0x9C, 0xCC, 0xE4, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xC0, 
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xE0,
0xF0, 0xF0, 0xF8, 0xF8, 0xF8, 0xF8, 0xFC, 0xFE, 0xFE, 0xFC, 0x38, 
0x70, 0x70, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x3F, 0x7F, 0xFF,
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F, 0x3F, 0x06, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x3F, 0x7F, 0x7F, 0x7F, 0xFF, 
0xFF, 0x7F, 0x7F, 0x7F, 0x3F, 0x1F, 0x02, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0xC0, 
0xE0, 0x60, 0x70, 0x70, 0x30, 0x30, 0x30, 0x38, 0x38, 0x38, 0x38, 
0x30, 0x30, 0x30, 0x70, 0x70, 0x60, 0xC0, 0xC0, 0xC0, 0x80, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x30, 0x3C, 0x3E, 0x0F, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x01, 0x03, 0x07, 0x0F, 0x3E, 0x7C, 0x78, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 
};

//icono exceso de luz
static unsigned char sol[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xC0, 0xC0, 0xC0, 0xC0, 
0xC0, 0xC0, 0xC0, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 
0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 
0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x40, 0x44, 0xC0, 0xC0, 0xC0, 
0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0x80, 0x80, 0x80, 0x80, 0x80, 
0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFC, 
0xFC, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 0xF8, 
0xF8, 0xF8, 0xF8, 0xFC, 0xFD, 0xFF, 0xFF, 0xFF, 0x3F, 0x07, 0x07, 
0x07, 0x07, 0x07, 0x07, 0x07, 0x1F, 0x7F, 0xFF, 0xFF, 0xFD, 0xFD, 
0xFC, 0xFC, 0xFC, 0xFC, 0xFC, 0xF8, 0xFC, 0xFC, 0xF8, 0xF8, 0xFC, 
0xFC, 0xFC, 0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x0F, 0x07, 0x00, 
0x00, 0x00, 0x00, 0x07, 0x0F, 0x1F, 0x3F, 0x3F, 0x7F, 0x7F, 0x7F, 
0x7F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x3F, 0x3F, 0x3F, 0x1F, 0x0F, 
0x0F, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x0F, 0x0F, 0x1F, 0x3F, 0x3F, 
0x3F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0xFF,
0xFF, 0xFF, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x3F, 0x3F, 
0x1F, 0x0F, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x70, 0x60, 0x60, 0x60, 0x60, 
0x60, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 
0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

//icono calor
static unsigned char calor[]= {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x78, 0x88, 0x88, 
0x0C, 0x32, 0x23, 0x03, 0x02, 0x04, 0x84, 0x08, 0x08, 0x0C, 0x02, 
0x02, 0x40, 0x04, 0x84, 0x88, 0x08, 0x10, 0x10, 0x30, 0x20, 0x20, 
0x40, 0x40, 0x40, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x20, 0x20, 0x00, 0x20, 0xB0, 0x90, 0x48, 0x48, 0x24, 
0x30, 0x10, 0x08, 0x08, 0x08, 0x30, 0x34, 0x0C, 0x0C, 0x06, 0x07, 
0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x07, 0x07, 0x07, 0x01, 0x01, 
0x47, 0xFD, 0x78, 0x30, 0x11, 0x33, 0x23, 0x23, 0x07, 0x46, 0x44, 
0x44, 0x04, 0x80, 0x80, 0x81, 0x03, 0x03, 0x83, 0x80, 0x40, 0x40, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x83, 0xE6, 0x3C, 0x8C, 0xF8, 0xE0, 0xC0, 0x80, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x78, 0x7C, 
0x36, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x40, 0x40, 
0x40, 0x40, 0xC0, 0xC0, 0x40, 0x60, 0xB0, 0xB0, 0xB8, 0xF8, 0xF8, 
0x78, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 
0xF0, 0xF0, 0x70, 0xB0, 0x30, 0x78, 0xC4, 0xC4, 0x80, 0x20, 0x32, 
0x32, 0x13, 0x13, 0x10, 0x70, 0x50, 0x90, 0x90, 0x90, 0x90, 0x10, 
0x50, 0xB8, 0x78, 0x48, 0x04, 0x04, 0x02, 0x03, 0x01, 0x06, 0x07, 
0x0F, 0x3F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xF8, 0xC0, 0x02, 
0x03, 0x02, 0xFF, 0xFF, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 
0x03, 0x03, 0x03, 0x03, 0x03, 0x01, 0x00, 0x80, 0x80, 0x80, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x03, 
0x03, 0x23, 0x23, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xFF, 
0x3E, 0x38, 0x3C, 0x3C, 0x3C, 0x1C, 0x1C, 0x0E, 0x0E, 0x0F, 0x0F, 
0x07, 0x07, 0x07, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 
0x0F, 0x38, 0x30, 0x60, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x78, 0xFE, 0xFF, 0xFC, 0xFC, 0xFC, 0xBC, 0x3C, 0x3C, 0x3C, 0x3C, 
0x3C, 0x7C, 0x7C, 0x7C, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x80, 0xC0, 0x40, 0x30, 0x18, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x01, 0x03, 0x02, 0x06, 0x04, 0x08, 0x08, 0x18, 0x30, 0x30, 
0x30, 0x20, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x80, 0x80, 0x80, 
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 
0x00, 0x00, 0x00, 0x40, 0x40, 0x40, 0x00, 0x20, 0x20, 0x30, 0x10, 
0x08, 0x08, 0x0C, 0x04, 0x04, 0x02, 0x03, 0x01, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 
};

//icono frio
static unsigned char frio[]= {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0xC0, 0xC0, 0xE0, 
0xF0, 0xF0, 0xF8, 0xF8, 0x78, 0x70, 0xF4, 0x3C, 0x7C, 0x78, 0x7A, 
0x5E, 0x5E, 0xCF, 0xCF, 0xCD, 0x4D, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 
0x0F, 0x0F, 0x8F, 0x9E, 0x9E, 0x9E, 0xBC, 0xBC, 0xBC, 0xBC, 0xFC, 
0x78, 0x78, 0xF8, 0xF0, 0xF0, 0xE0, 0xC0, 0xC0, 0x80, 0x80, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x80, 0x80, 0xC0, 0xC0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF8, 
0xFA, 0x7F, 0x77, 0x37, 0x07, 0x07, 0x03, 0x03, 0xC1, 0x34, 0x08, 
0x09, 0x04, 0x04, 0x84, 0x84, 0x84, 0x84, 0x08, 0x08, 0x30, 0xC0, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x61, 
0x11, 0x08, 0x04, 0x04, 0x84, 0x84, 0x85, 0x05, 0x03, 0x0A, 0x14, 
0x41, 0x03, 0x03, 0x07, 0x0F, 0x0F, 0x4F, 0x7E, 0xFC, 0xF0, 0xF0, 
0xF0, 0xF0, 0xE0, 0xE0, 0xE0, 0xE0, 0xC0, 0xC0, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0xE0, 0xF8, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0x7F, 0x1F, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x06, 0x70, 0x80, 0x00, 0x00, 0x3F, 0x39, 0x79, 
0x7F, 0x7F, 0x7F, 0x6F, 0x3E, 0x80, 0x60, 0x0C, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0x80, 0x00, 0x3C, 0x6F, 0x7F, 
0xFF, 0x7F, 0x79, 0x7B, 0x3F, 0x0C, 0x80, 0x40, 0x3F, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x1F, 0x7F, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xF8, 0xC0, 0x00, 0xBF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0xC0, 0xC0, 
0xC0, 0xE0, 0xE0, 0x60, 0x60, 0x60, 0xC0, 0xC0, 0x60, 0x60, 0x60,
0xC0, 0xC0, 0xC0, 0xC0, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x7E, 0x00, 0x01, 0x07, 0x0F, 0x1F, 
0x3F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0xFF, 0x7C, 0x70, 0x60, 0x40, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 
0xFC, 0xFE, 0xFF, 0xF7, 0x5B, 0x79, 0x69, 0x6C, 0x74, 0x35, 0x3C, 
0x3C, 0x30, 0x3F, 0x3C, 0x30, 0x3C, 0x3C, 0x34, 0x74, 0x7C, 0x69,
0x79, 0xCF, 0xF7, 0xFE, 0xFC, 0xF8, 0xF0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xE0, 0xF8, 0xFC, 
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F, 0x3F, 0x1F, 0x0F, 
0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};


//Sin luz
static unsigned char oscuridad[]= {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x0C, 0x14, 
0x14, 0x14, 0x10, 0x10, 0x10, 0x90, 0x90, 0x10, 0x50, 0x72, 0x30, 
0x00, 0x00, 0x80, 0x80, 0x40, 0xC0, 0xE4, 0xF4, 0x5C, 0x4C, 0x40, 
0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 
0x40, 0x40, 0x40, 0x00, 0x00, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x80, 0x80, 0xC0, 0x40, 0x60, 0x30, 0x30, 0x18, 
0x08, 0x08, 0x04, 0x04, 0x34, 0x2E, 0x4E, 0x47, 0x47, 0x43, 0x43, 
0x41, 0x40, 0x40, 0x4C, 0x4C, 0x4A, 0x4B, 0x4B, 0x49, 0x48, 0x48, 
0x48, 0x48, 0x09, 0x8B, 0xAA, 0xB2, 0x52, 0x42, 0x22, 0x32, 0x12, 
0x8A, 0x8A, 0x4A, 0x46, 0x20, 0x30, 0x30, 0x10, 0x08, 0x08, 0x04, 
0x04, 0x03, 0x03, 0x02, 0x06, 0x04, 0x04, 0x0C, 0x08, 0x08, 0x18, 
0x30, 0x30, 0x60, 0x40, 0xC0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0x3C, 0x0C, 0x07, 0x03, 
0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xC0, 0x80, 0x80, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x80, 0x80, 0xC0, 0x80, 0x00, 0x00, 0x06, 0x07, 0x01, 
0x00, 0x00, 0x08, 0x08, 0x08, 0x08, 0xC8, 0xC8, 0xC9, 0x89, 0x09,
0x09, 0x09, 0x09, 0x01, 0x01, 0x01, 0x05, 0x05, 0x05, 0x07, 0x02, 
0x00, 0x80, 0x80, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x01, 0x03, 0x07, 0x0C, 0x38, 0xF0, 0xC0, 0x00, 0x00, 0x00, 
0x3F, 0xFF, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x03, 0x03, 0x07, 0x07, 0x07, 0x0E, 0x0E, 0x0C, 
0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0E, 0x06, 0x07, 0x07, 0x03, 
0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x01, 0x03, 0x07, 0x07, 0x07, 0x07, 0x06, 0x0E, 
0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x06, 0x07, 0x07, 0x07, 0x03, 0x03, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x80, 0xF3, 0xFF, 0x1F, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 
0x0C, 0x18, 0x30, 0x70, 0x40, 0xC0, 0x80, 0x80, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x08, 0x18, 0x18, 0x18, 0x10, 0x10, 0x10, 0x10,
0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x18, 
0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x80, 0x80, 0xC0, 0x60, 0x70, 0x38, 0x1C, 0x0E, 0x07, 0x03, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x01, 0x03, 0x03, 0x06, 0x04, 0x04, 0x0C, 0x08, 
0x08, 0x08, 0x10, 0x10, 0x30, 0x30, 0x30, 0x20, 0x20, 0x60, 0x40, 
0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 
0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 
0x40, 0x60, 0x20, 0x20, 0x30, 0x30, 0x30, 0x10, 0x10, 0x08, 0x08, 
0x08, 0x0C, 0x04, 0x04, 0x06, 0x03, 0x03, 0x01, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 

};



void setup(){
  
 
  Serial.begin(9600);//Iniciamos la comunicación serial                
  dht.begin(); //Iniciamos el sensor de humedad y temperatura    
  NokiaLCD.init();   //Iniciar pantalla
  
  NokiaLCD.clear();  //Limpiar pantalla
  
  //iniciarlizar variables 
  AntTemp = 0;//Variable de la ultma temperatura medida
  AntHum = 0;//Variable de la ultima humedad de aire medida
  
  //configuracion de pines
  pinMode(backlight,OUTPUT);//Pin conectado a la iluminacion de la pantalla
  attachInterrupt(0, colision, CHANGE);//iniciamos la interrupcion para el boton      
  pinMode(2, INPUT);//COnfiguramos el pin 2 (el del boton) como salida
  digitalWrite(2, HIGH);//Activamos la resistencia Pull-Up en el pin 2 (el del boton)
}

void loop(){
      
  //Mostramos la información en la consola      
  Serial.print("Humedad: ");     
  Serial.println(dht.readHumidity());    
  Serial.print("Temperatura: ");    
  Serial.println(dht.readTemperature());    
  
  //Leemos la informacion de los sensores
  Acthum = dht.readHumidity();//leemos humedad
  ActTemp = dht.readTemperature();//leemos temperatura    
  
  dtostrf(dht.readTemperature(), 5, 2, temperatura); //cast de la temperatura
  dtostrf(dht.readHumidity(), 5, 2, humedad);//cast de la humedad
  if(tMenu == true){
    
    //Menu Grafico
    NokiaLCD.clear();//Limpiamos la pantalla
    Serial.println("MENU GRAFICO");
    /*NokiaLCD.print("Modo Grafico");*/    
    NokiaLCD.bitmap(sol);
    if(luminosidad < umbralOscuridad){NokiaLCD.bitmap(oscuridad);}//Si la habitacion esta oscura mostramos la cara que duerme
    else if(luminosidad < umbralLuminosidad){NokiaLCD.bitmap(sol);}//Si hay demasiada luminosidad mostramos la cara con gafas de sol
    else if(ActTemp < umbralFrio){NokiaLCD.bitmap(frio);}//Si la temperatura es inferior a lo que tenemos configurado, mostramos frio
    else if(ActTemp > umbralCalor){NokiaLCD.bitmap(calor);}//Si la temperatura es superior a lo que tenemos configurado, mostramos calor
    else if(HumTierra < umbralHumedad){NokiaLCD.bitmap(triste);}//Si la planta necesita riego, mostramos la cara triste
    else{NokiaLCD.bitmap(smille);}
  }else{
    //menu de texto con las lecturas tomadas. 
    NokiaLCD.clear();//Limpiamos la pantalla
    Serial.println("Texto");
    NokiaLCD.setCursor(1,1);  
    NokiaLCD.print(temperatura);  
    
    NokiaLCD.setCursor(1,2);  
    NokiaLCD.print(humedad);  
    
    NokiaLCD.setCursor(1,3);  
    NokiaLCD.print("Suelo: ");  
  
    NokiaLCD.setCursor(1,5);  
    NokiaLCD.print("Trastejant"); 
  }
  
  //Encendemos la pantalla si hay alguna alteracion
  Acthum = dht.readHumidity();//leemos humedad
  ActTemp = dht.readTemperature();//leemos temperatura
  
  if(AntTemp != ActTemp){
    digitalWrite(backlight,HIGH);//encendemos la iluminacion del display
    AntTemp = ActTemp;//guardamos la nueva temperatura
  }
  
  if(AntHum != Acthum){
    digitalWrite(backlight,HIGH);//encendemos la iluminacion del display
    AntHum = Acthum;//guardamos la nueva humedad
  }
  
  delay(3000);//tiempo con el display iluminado   
  digitalWrite(backlight,LOW);//apagamos la iluminacion del display
}

 void colision(){tMenu = !tMenu;}  //Funcion llamada en caso de interrupcion
 void mensaje(){Serial.println("Boton pulsado");}
